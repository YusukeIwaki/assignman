### **データベースの主要なテーブル（エンティティ）**

サービスの要件を実現するために、以下の概念を表すテーブルを設計します。

#### **1\. 組織 (Organizations)**

* **目的**: 顧客となる企業や団体ごとデータを分離し、管理するための最上位の入れ物です 1。これにより、複数の企業が同じシステムを安全に利用できる状態（マルチテナント）を実現します。

* **主な構造**:  
  * **組織名**: 登録された企業や部署を識別するための名前。

#### **2\. ユーザー (Users)**

* **目的**: システム内でのユーザー識別のためのコアエンティティです。認証情報や公開プロフィール情報は分離されています。

* **主な構造**:  
  * **ID**: プライマリキー  
  * **所属組織**: どの組織に属するユーザーかを示す情報  
  * **作成日時・更新日時**: レコードのタイムスタンプ

#### **2-1\. ユーザー認証情報 (UserCredentials)**

* **目的**: ユーザーのログイン認証に必要な機密情報を管理します。認可（権限）情報は含まず、純粋に認証のためのデータのみを扱います。

* **主な構造**:  
  * **ユーザー参照**: どのユーザーの認証情報かを示すID  
  * **メールアドレス**: ログインに使用する識別子（一意制約）  
  * **パスワードダイジェスト**: ハッシュ化されたパスワード  
  * **作成日時・更新日時**: レコードのタイムスタンプ

* **設計思想**: 認証（Authentication）と認可（Authorization）を分離。権限情報は別モデルで管理することで、複雑な権限システムを柔軟に実装可能にします。

#### **2-2\. ユーザープロフィール (UserProfiles)**

* **目的**: ユーザーの公開可能なプロフィール情報を管理します。認証情報とは分離され、表示やキャッシュに最適化できます。

* **主な構造**:  
  * **ユーザー参照**: どのユーザーのプロフィールかを示すID  
  * **表示名**: システム内で表示される名前  
  * **自己紹介文**: オプションの説明文  
  * **アバターURL**: プロフィール画像のURL（オプション）  
  * **作成日時・更新日時**: レコードのタイムスタンプ

#### **3\. メンバー (Members)**

* **目的**: プロジェクトにアサインされる「人的リソース」のプロフィール情報を管理します 4。これはシステムにログインする「ユーザー」とは別の概念です 5。これにより、ログイン権限を持たない外部パートナーなども管理対象に含められます 6。

* **主な構造**:  
  * **所属組織**: どの組織に属するメンバーかを示す情報。  
  * **名前**: メンバーを識別するための氏名。  
  * **役割**: 「エンジニア」や「デザイナー」といった、そのメンバーの主要な職務 7。

  * **稼働キャパシティ**: そのメンバーが標準でどれくらいの業務量（例: 100%）をこなせるかを示す基準値 8。

#### **4\. プロジェクト (Projects)**

* **目的**: 開始日と終了日を持つ、独立した仕事の単位を管理します 9。アサインの対象となる業務コンテナです。

* **主な構造**:  
  * **所属組織**: どの組織のプロジェクトかを示す情報。  
  * **プロジェクト名**: プロジェクトを識別するための名前。  
  * **期間**: プロジェクトの開始日と終了日。  
  * **ステータス**: 「未確定」「確定」「アーカイブ」といった、プロジェクトの進行状況 10。

#### **5\. アサイン (Assignments)**

* **目的**: 「どのメンバー」を「どのプロジェクト」に、「いつからいつまで」「どれくらいの比重で」割り当てるかを記録する、システムの中核となる情報です 11。

* **主な構造**:  
  * **対象プロジェクト**: どのプロジェクトへの割り当てかを示す情報 12。

  * **担当メンバー**: どのメンバーを割り当てるかを示す情報 13。

  * **期間**: アサインの開始日と終了日。  
  * **アサイン率**: その期間中、メンバーの稼働キャパシティのうち何%をこのプロジェクトに割り当てるかを示す数値 14。

#### **6\. 役割 (Roles) と スキル (Skills)**

* **目的**: メンバーの属性を構造化するためのマスターデータです。「役割」はメンバーの職務（例: エンジニア）を 15、「スキル」は特定の専門技能（例: Python）を表します 16。これらにより、高度なリソース検索が可能になります。

* **主な構造**:  
  * **所属組織**: どの組織で定義された役割・スキルかを示す情報。  
  * **名称**: 「エンジニア」や「Python」といった役割・スキルの名前。

#### **7\. メンバースキル (MemberSkills)**

* **目的**: 一人の「メンバー」が複数の「スキル」を持つという関係（多対多）を実現するための、両者をつなぐ中間的なテーブルです。  
* **主な構造**:  
  * **対象メンバー**: どのメンバーかを示す情報。  
  * **対象スキル**: どのスキルかを示す情報。

---

### **エンティティ関連（リレーションシップ）**

上記の各テーブル（概念）は、以下のように相互に関連します。

* **プロジェクト**は、多数の**アサイン**を持つことができます 17。

* **メンバー**もまた、多数の**アサイン**を持つことができます 18。

* 一つの  
  **アサイン**は、必ず一つの**プロジェクト**と一人の**メンバー**に紐付きます 19。

* 一人の  
  **メンバー**は、一つの主要な**役割**を持ち 20、多数の

  **スキル**を持つことができます 21。

* **組織**は、その組織に属する全ての**ユーザー**、**メンバー**、**プロジェクト**、**役割**、**スキル**を保有します 22。

---

### **クエリ設計に関する考慮事項**

このデータベース構造は、以下の重要な業務ロジックを効率的に処理するために不可欠です。

* **メンバーの稼働率計算**: 特定の期間において、各メンバーに紐づく全ての**アサイン**情報を集計し、**アサイン率**を合算する必要があります。  
* **オーバーアロケーションの検出**: 新しい**アサイン**が追加・変更された際、メンバーの**アサイン率**の合計が、そのメンバーの持つ**稼働キャパシティ**（例: 100%）を超過する日がないかをチェックする必要があります 23。

* **リソースの空き状況検索**: 「特定の**スキル**を持ち、かつ指定期間内の**アサイン率**が一定以下の**メンバー**」といった高度な検索要件に応える必要があります 24。これは、複数のテーブルをまたいだ複雑なデータ検索が求められることを意味します。  
